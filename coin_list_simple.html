<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>å¸ååˆ—è¡¨ç®€å•æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0a192f;
            color: #fff;
            padding: 40px;
        }
        
        .box {
            background: rgba(22, 33, 62, 0.9);
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            margin: 0 auto;
            border: 2px solid rgba(74, 158, 255, 0.5);
        }
        
        h1 {
            color: #4a9eff;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }
        
        .section-title {
            color: #00ff88;
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .coin-list {
            padding: 10px;
            border: 1px solid rgba(74, 158, 255, 0.3);
            border-radius: 8px;
            min-height: 50px;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .coin-tag {
            display: inline-block;
            padding: 6px 12px;
            margin: 4px;
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.3) 0%, rgba(102, 126, 234, 0.3) 100%);
            border: 1px solid rgba(74, 158, 255, 0.6);
            border-radius: 6px;
            color: #4a9eff;
            font-size: 14px;
            font-weight: 700;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .coin-tag:hover {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.5) 0%, rgba(102, 126, 234, 0.5) 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 158, 255, 0.4);
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: #00ff88;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <div class="box">
        <h1>ğŸª™ å¸ååˆ—è¡¨æ˜¾ç¤ºæµ‹è¯•</h1>
        
        <div style="text-align: center; margin: 20px 0;">
            <button onclick="loadAndDisplay()">ğŸ”„ åŠ è½½å¸ç§æ•°æ®</button>
            <button onclick="testStaticDisplay()">âœ¨ æµ‹è¯•é™æ€æ˜¾ç¤º</button>
        </div>
        
        <div class="section">
            <div class="section-title">8ï¸âƒ£ åªæœ‰æ€¥æ¶¨çš„å¸ç§</div>
            <div class="coin-list" id="onlyRushUp">
                <span style="color: #888;">ç‚¹å‡»æŒ‰é’®åŠ è½½æ•°æ®...</span>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">9ï¸âƒ£ æ€¥æ¶¨>æ€¥è·Œçš„å¸ç§</div>
            <div class="coin-list" id="upGreaterDown">
                <span style="color: #888;">ç‚¹å‡»æŒ‰é’®åŠ è½½æ•°æ®...</span>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ğŸ”Ÿ ä¼˜å…ˆçº§â‰¥4çš„å¸ç§</div>
            <div class="coin-list" id="priority">
                <span style="color: #888;">ç‚¹å‡»æŒ‰é’®åŠ è½½æ•°æ®...</span>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">1ï¸âƒ£1ï¸âƒ£ åªæœ‰æ€¥è·Œçš„å¸ç§</div>
            <div class="coin-list" id="onlyRushDown">
                <span style="color: #888;">ç‚¹å‡»æŒ‰é’®åŠ è½½æ•°æ®...</span>
            </div>
        </div>
        
        <div class="status" id="status"></div>
    </div>
    
    <script>
        // æµ‹è¯•é™æ€æ˜¾ç¤º
        function testStaticDisplay() {
            document.getElementById('onlyRushUp').innerHTML = 
                '<span class="coin-tag">FIL</span>' +
                '<span class="coin-tag">LINK</span>' +
                '<span class="coin-tag">DOT</span>';
            
            document.getElementById('upGreaterDown').innerHTML = 
                '<span class="coin-tag">SUI</span>' +
                '<span class="coin-tag">BCH</span>' +
                '<span class="coin-tag">FIL</span>' +
                '<span class="coin-tag">LINK</span>' +
                '<span class="coin-tag">DOT</span>';
            
            document.getElementById('priority').innerHTML = 
                '<span class="coin-tag">BCH</span>';
            
            document.getElementById('onlyRushDown').innerHTML = 
                '<span class="coin-tag">LDO</span>';
            
            document.getElementById('status').innerHTML = 
                'âœ… é™æ€æµ‹è¯•æ•°æ®å·²åŠ è½½ï¼ˆå¦‚æœä½ èƒ½çœ‹åˆ°è“è‰²æ ‡ç­¾ï¼Œè¯´æ˜æ ·å¼æ­£å¸¸ï¼‰';
        }
        
        // ä»APIåŠ è½½çœŸå®æ•°æ®
        async function loadAndDisplay() {
            try {
                document.getElementById('status').innerHTML = 'â³ æ­£åœ¨åŠ è½½æ•°æ®...';
                
                const response = await fetch('/api/home-data');
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'æ•°æ®åŠ è½½å¤±è´¥');
                }
                
                const coins = data.data.coins;
                console.log('Total coins:', coins.length);
                
                // 8. åªæœ‰æ€¥æ¶¨
                const onlyRushUp = coins.filter(c => {
                    const up = parseInt(c.rushUp) || 0;
                    const down = parseInt(c.rushDown) || 0;
                    return up > 0 && down === 0;
                });
                
                // 9. æ€¥æ¶¨>æ€¥è·Œ
                const upGreaterDown = coins.filter(c => {
                    const up = parseInt(c.rushUp) || 0;
                    const down = parseInt(c.rushDown) || 0;
                    return up > down;
                });
                
                // 10. ä¼˜å…ˆçº§â‰¥4
                const priority = coins.filter(c => {
                    const p = calculatePriority(c.ratio1, c.ratio2);
                    return p.level >= 1 && p.level <= 4;
                });
                
                // 11. åªæœ‰æ€¥è·Œ
                const onlyRushDown = coins.filter(c => {
                    const up = parseInt(c.rushUp) || 0;
                    const down = parseInt(c.rushDown) || 0;
                    return down > 0 && up === 0;
                });
                
                // æ˜¾ç¤ºç»“æœ
                displayCoins('onlyRushUp', onlyRushUp);
                displayCoins('upGreaterDown', upGreaterDown);
                displayCoins('priority', priority);
                displayCoins('onlyRushDown', onlyRushDown);
                
                document.getElementById('status').innerHTML = 
                    `âœ… æ•°æ®åŠ è½½æˆåŠŸï¼<br>` +
                    `åªæœ‰æ€¥æ¶¨: ${onlyRushUp.length} ä¸ª<br>` +
                    `æ€¥æ¶¨>æ€¥è·Œ: ${upGreaterDown.length} ä¸ª<br>` +
                    `ä¼˜å…ˆçº§â‰¥4: ${priority.length} ä¸ª<br>` +
                    `åªæœ‰æ€¥è·Œ: ${onlyRushDown.length} ä¸ª`;
                    
            } catch (error) {
                document.getElementById('status').innerHTML = 
                    `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
                console.error('Error:', error);
            }
        }
        
        function displayCoins(elementId, coins) {
            const html = coins.map(c => 
                `<span class="coin-tag">${c.symbol}</span>`
            ).join('');
            
            document.getElementById(elementId).innerHTML = 
                html || '<span style="color: #888;">æ— æ•°æ®</span>';
        }
        
        function calculatePriority(ratio1Str, ratio2Str) {
            try {
                const ratio1 = parseFloat(ratio1Str.replace('%', ''));
                const ratio2 = parseFloat(ratio2Str.replace('%', ''));
                
                if (ratio1 > 90 && ratio2 > 120) return { level: 1, text: 'ç­‰çº§1' };
                if (ratio1 > 80 && ratio2 > 120) return { level: 2, text: 'ç­‰çº§2' };
                if (ratio1 > 90 && ratio2 > 110) return { level: 3, text: 'ç­‰çº§3' };
                if (ratio1 > 80 && ratio2 > 110) return { level: 4, text: 'ç­‰çº§4' };
                if (ratio1 > 70 && ratio2 > 110) return { level: 5, text: 'ç­‰çº§5' };
                return { level: 6, text: 'ç­‰çº§6' };
            } catch {
                return { level: 6, text: 'ç­‰çº§6' };
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºé™æ€æµ‹è¯•æ•°æ®
        window.onload = function() {
            testStaticDisplay();
        };
    </script>
</body>
</html>
