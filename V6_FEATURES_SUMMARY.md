# ✨ v6.0 核心功能总结

## 🎯 已实现的用户需求

### 1️⃣ **差值曲线图**
✅ 在趋势图中显示"差值(急涨-急跌)"曲线  
✅ 差值使用独立的第二Y轴（右侧）  
✅ 自动计算: `差值 = 急涨 - 急跌`

**示例**:
```
急涨=15, 急跌=4  →  差值=11
```

---

### 2️⃣ **智能高亮标记**
✅ 满足条件的数据点自动放大和变色

| 条件 | 高亮效果 |
|------|---------|
| **急涨 ≥ 10** | 亮绿色 + 10px大点 |
| **急跌 ≥ 10** | 亮红色 + 10px大点 |
| **差值 ≥ 50** | 橙色 + 10px大点 |
| **差值 ≤ -50** | 橙色 + 10px大点 |

**不满足条件的点**: 半透明色 + 4px小点

---

### 3️⃣ **精确时间戳机制**
✅ 更新时间 = TXT文件时间戳 + 1分钟  
✅ 不使用浏览器本地时间  
✅ 倒计时基于文件时间计算

**时间流程**:
```
TXT文件: 18:06:00
   ↓ +1分钟
更新时间: 18:07:00  ← 图表X轴显示
   ↓ +10分钟
下次更新: 18:17:00  ← 倒计时目标
```

---

## 📊 图表说明

```
急涨急跌趋势统计

左Y轴                         右Y轴
(急涨/急跌)                   (差值)

    ●●●                      
   ●   ●        ◆            50
  ●     ●      ● ●           
 ●       ●    ●   ●          30
          ●  ●     ●         
         ●  ●       ●        10
        ●             ●       
       ●               ●     0

绿线 = 急涨 (左Y轴)
红线 = 急跌 (左Y轴)
蓝线 = 差值 (右Y轴)

● 大点 (10px) = 高亮数据
● 小点 (4px) = 正常数据
```

---

## 🎨 颜色系统

### 曲线颜色
- 🟢 **急涨**: 绿色线条 + 浅绿填充
- 🔴 **急跌**: 红色线条 + 浅红填充
- 🔵 **差值**: 蓝色线条 (不填充)

### 数据点颜色
| 状态 | 颜色 | 大小 |
|------|------|------|
| 急涨 ≥10 | #00ff00 (亮绿) | 10px |
| 急涨 <10 | rgba(0,204,0,0.6) (半透明绿) | 4px |
| 急跌 ≥10 | #ff0000 (亮红) | 10px |
| 急跌 <10 | rgba(204,0,0,0.6) (半透明红) | 4px |
| 差值高亮 | #ff6600 (橙色) | 10px |
| 差值正常 | #0080ff (蓝色) | 4px |

---

## 🔍 如何验证功能

### 方法1: 浏览器查看
1. 访问: `https://5001-xxx.sandbox.novita.ai/?v=6`
2. 查看图表中的大点（应该明显比小点大）
3. 悬停在点上查看具体数值

### 方法2: 控制台日志
1. 按 `F12` 打开开发者工具
2. 切换到"Console"标签
3. 查看日志输出:
   ```
   文件时间: 2025-12-02 18:06:00
   更新时间(+1分钟): 18:07
   添加新数据点: 18:07, 急涨:15, 急跌:4, 差值:11
   ```

### 方法3: 运行测试脚本
```bash
cd /home/user/webapp
python3 test_v6_features.py
```

测试结果示例:
```
✅ 差值计算正确: 15 - 4 = 11
✅ 高亮条件统计:
   急涨≥10的点: 63 个
   急跌≥10的点: 17 个
   差值≥50的点: 0 个
```

---

## 📈 数据统计

### 当前演示数据
- **币种数量**: 29个
- **历史数据点**: 约67个 (从08:00到19:00)
- **高亮点比例**: 约80个高亮点

### 数据更新
- **更新频率**: 每10分钟
- **数据来源**: Google Drive TXT文件
- **自动加载**: 启动时加载当天所有历史数据

---

## 🚀 快速开始

### 启动服务器
```bash
# 演示版本（模拟数据）
python3 crypto_server_demo.py

# 真实版本（需要Google Drive API）
python3 crypto_server.py
```

### 访问页面
```
https://5001-ivx1gqv2svtq7f2kvor6q-b32ec7bb.sandbox.novita.ai/?v=6
```

### 强制刷新
- Windows/Linux: `Ctrl + F5`
- Mac: `Cmd + Shift + R`
- 或使用隐身模式

---

## ✅ 功能完成度

| 功能 | 状态 | 说明 |
|------|------|------|
| 差值曲线 | ✅ 完成 | 蓝色曲线，右Y轴 |
| 急涨高亮 (≥10) | ✅ 完成 | 亮绿色，10px |
| 急跌高亮 (≥10) | ✅ 完成 | 亮红色，10px |
| 差值高亮 (≥50或≤-50) | ✅ 完成 | 橙色，10px |
| 文件时间+1分钟 | ✅ 完成 | 精确计算 |
| 10分钟自动更新 | ✅ 完成 | 基于文件时间 |
| 历史数据加载 | ✅ 完成 | 当天所有数据 |
| 29币种监控 | ✅ 完成 | 完整数据 |

---

## 🎊 总结

**v6.0版本完全实现了用户的所有需求**:

1. ✅ **差值曲线**: 蓝色曲线，独立Y轴
2. ✅ **智能高亮**: 急涨≥10, 急跌≥10, 差值≥50/≤-50
3. ✅ **精确时间**: 文件时间戳 + 1分钟

**系统已就绪，可以投入使用！** 🚀
