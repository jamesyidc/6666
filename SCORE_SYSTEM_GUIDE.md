# åŠ å¯†è´§å¸å¾—åˆ†ç³»ç»Ÿä½¿ç”¨æŒ‡å— ğŸ“Š

## ğŸ“Œ ç³»ç»Ÿæ¦‚è§ˆ

**å¾—åˆ†ç³»ç»Ÿ V1.0** æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„åŠ å¯†è´§å¸è¯„åˆ†åˆ†æå¹³å°ï¼Œç”¨äºï¼š
- æ•´åˆå¤šä¸ªæ•°æ®æºï¼ˆ19ç§å¸ + 8ç§å¸ï¼‰
- ç»Ÿè®¡å¤šä¸ªæ—¶é—´æ®µï¼ˆ3åˆ†é’Ÿã€1å°æ—¶ã€3å°æ—¶ã€6å°æ—¶ã€12å°æ—¶ã€24å°æ—¶ï¼‰
- è®¡ç®—åšå¤š/åšç©ºçš„å¹³å‡å¾—åˆ†å’Œå·®å€¼

---

## ğŸš€ å¿«é€Ÿè®¿é—®

### ä¸»è¦æœåŠ¡åœ°å€

| æœåŠ¡ | URL | è¯´æ˜ |
|------|-----|------|
| ğŸŒ Webä¸»é¡µ | https://5009-ivx1gqv2svtq7f2kvor6q-b32ec7bb.sandbox.novita.ai/ | å¯è§†åŒ–ç•Œé¢ |
| ğŸ“Š ç»Ÿè®¡API | https://5009-ivx1gqv2svtq7f2kvor6q-b32ec7bb.sandbox.novita.ai/api/score/statistics | è·å–ç»Ÿè®¡æ•°æ® |
| ğŸ’° å¸ç§API | https://5009-ivx1gqv2svtq7f2kvor6q-b32ec7bb.sandbox.novita.ai/api/score/coins | è·å–å„å¸ç§è¯¦ç»†å¾—åˆ† |
| ğŸ”„ åˆ·æ–°API | https://5009-ivx1gqv2svtq7f2kvor6q-b32ec7bb.sandbox.novita.ai/api/score/refresh | æ‰‹åŠ¨åˆ·æ–°æ•°æ® |

---

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### 1. ç»Ÿè®¡åŠŸèƒ½

ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å¹¶æ˜¾ç¤ºä»¥ä¸‹ç»Ÿè®¡æ•°æ®ï¼š

**å„æ—¶é—´æ®µç»Ÿè®¡æŒ‡æ ‡ï¼š**
- âœ… å¹³å‡åšå¤šå¾—åˆ†ï¼ˆLong Score Averageï¼‰
- âœ… å¹³å‡åšç©ºå¾—åˆ†ï¼ˆShort Score Averageï¼‰
- âœ… å¹³å‡å·®å€¼ï¼ˆAverage Differenceï¼‰= åšå¤šå¾—åˆ† - åšç©ºå¾—åˆ†
- âœ… å¸ç§æ•°é‡ï¼ˆCoin Countï¼‰
- âœ… è¶‹åŠ¿åˆ¤æ–­ï¼ˆğŸ“ˆ çœ‹å¤š / ğŸ“‰ çœ‹ç©ºï¼‰

**æ”¯æŒçš„æ—¶é—´èŒƒå›´ï¼š**
```
3m  - 3åˆ†é’Ÿ
1h  - 1å°æ—¶
3h  - 3å°æ—¶
6h  - 6å°æ—¶
12h - 12å°æ—¶
24h - 24å°æ—¶
```

### 2. æ•°æ®æºæ•´åˆ

ç³»ç»Ÿè®¾è®¡ä¸ºæ”¯æŒå¤šæ•°æ®æºï¼š

**æ•°æ®æº1 - 19ç§å¸ï¼š**
```
BTC, ETH, BNB, SOL, DOT, LINK, ADA, FIL, DOGE, 
UNI, TAO, CFX, BCH, XLM, HBAR, ETC, AVAX, MATIC, OKB
```

**æ•°æ®æº2 - 8ç§å¸ï¼š**
```
FIL, UNI, TAO, CFX, BTC, HBAR, XLM, BCH
```

**åˆå¹¶ç­–ç•¥ï¼š**
- å»é‡å¤„ç†
- è‡ªåŠ¨åˆå¹¶ç›¸åŒå¸ç§çš„æ•°æ®
- ä¿ç•™æ‰€æœ‰æ—¶é—´æ®µçš„å®Œæ•´æ•°æ®

### 3. è‡ªåŠ¨æ›´æ–°

- â° **æ›´æ–°é¢‘ç‡**ï¼šæ¯ 3 åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°ä¸€æ¬¡
- ğŸ”„ **æ‰‹åŠ¨åˆ·æ–°**ï¼šæ”¯æŒé€šè¿‡Webç•Œé¢æˆ–APIæ‰‹åŠ¨è§¦å‘åˆ·æ–°
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨SQLiteæ•°æ®åº“ä¸­

---

## ğŸ”§ APIä½¿ç”¨è¯´æ˜

### 1. è·å–ç»Ÿè®¡æ•°æ®

**è¯·æ±‚ï¼š**
```bash
GET /api/score/statistics
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "update_time": "2025-12-03 15:16:46",
    "statistics": [
        {
            "time_range": "3m",
            "avg_long_score": 49.76,
            "avg_short_score": 49.59,
            "avg_diff": 0.17,
            "coin_count": 19,
            "trend": "ğŸ“ˆ çœ‹å¤š"
        },
        {
            "time_range": "1h",
            "avg_long_score": 45.81,
            "avg_short_score": 45.37,
            "avg_diff": 0.43,
            "coin_count": 19,
            "trend": "ğŸ“ˆ çœ‹å¤š"
        }
        // ... å…¶ä»–æ—¶é—´æ®µ
    ]
}
```

### 2. è·å–å„å¸ç§è¯¦ç»†å¾—åˆ†

**è¯·æ±‚ï¼š**
```bash
GET /api/score/coins?hours=24
```

**å‚æ•°ï¼š**
- `hours`ï¼ˆå¯é€‰ï¼‰ï¼šæŸ¥è¯¢æœ€è¿‘å¤šå°‘å°æ—¶çš„æ•°æ®ï¼Œé»˜è®¤24

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "BTC-USDT-SWAP": {
        "3m": {
            "long_score": 52.34,
            "short_score": 48.76,
            "diff": 3.58,
            "update_time": "2025-12-03 15:16:46"
        },
        "1h": {
            "long_score": 48.12,
            "short_score": 47.23,
            "diff": 0.89,
            "update_time": "2025-12-03 15:16:46"
        }
        // ... å…¶ä»–æ—¶é—´æ®µ
    },
    "ETH-USDT-SWAP": {
        // ... ç±»ä¼¼ç»“æ„
    }
    // ... å…¶ä»–å¸ç§
}
```

### 3. æ‰‹åŠ¨åˆ·æ–°æ•°æ®

**è¯·æ±‚ï¼š**
```bash
GET /api/score/refresh
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "success": true,
    "message": "æ•°æ®åˆ·æ–°æˆåŠŸ",
    "time": "2025-12-03 15:20:00"
}
```

---

## ğŸ“Š æ•°æ®åº“ç»“æ„

### è¡¨1: score_historyï¼ˆå¾—åˆ†å†å²è®°å½•ï¼‰

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| symbol | TEXT | å¸ç§ç¬¦å·ï¼ˆå¦‚BTC-USDT-SWAPï¼‰ |
| time_range | TEXT | æ—¶é—´èŒƒå›´ï¼ˆ3m/1h/3h/6h/12h/24hï¼‰ |
| long_score | REAL | åšå¤šå¾—åˆ† |
| short_score | REAL | åšç©ºå¾—åˆ† |
| score_diff | REAL | å¾—åˆ†å·®å€¼ |
| data_source | TEXT | æ•°æ®æ¥æº |
| record_time | DATETIME | è®°å½•æ—¶é—´ |

### è¡¨2: score_statisticsï¼ˆç»Ÿè®¡æ•°æ®ï¼‰

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| time_range | TEXT | æ—¶é—´èŒƒå›´ |
| avg_long_score | REAL | å¹³å‡åšå¤šå¾—åˆ† |
| avg_short_score | REAL | å¹³å‡åšç©ºå¾—åˆ† |
| avg_diff | REAL | å¹³å‡å·®å€¼ |
| coin_count | INTEGER | å¸ç§æ•°é‡ |
| update_time | DATETIME | æ›´æ–°æ—¶é—´ |

---

## ğŸ¨ Webç•Œé¢è¯´æ˜

### ä¸»è¦ç»„ä»¶

1. **ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ**
   - æ˜¾ç¤º6ä¸ªæ—¶é—´æ®µçš„ç»Ÿè®¡å¡ç‰‡
   - æ¯ä¸ªå¡ç‰‡åŒ…å«ï¼š
     - å¹³å‡åšå¤šå¾—åˆ†ï¼ˆç»¿è‰²ï¼‰
     - å¹³å‡åšç©ºå¾—åˆ†ï¼ˆçº¢è‰²ï¼‰
     - å¹³å‡å·®å€¼ï¼ˆå¸¦è¶‹åŠ¿æŒ‡ç¤ºï¼‰
     - å¸ç§æ•°é‡

2. **è¯¦ç»†æ•°æ®è¡¨æ ¼**
   - æ˜¾ç¤ºæ‰€æœ‰å¸ç§åœ¨å„æ—¶é—´æ®µçš„å¾—åˆ†
   - æ”¯æŒæ¨ªå‘æ»šåŠ¨æŸ¥çœ‹å®Œæ•´æ•°æ®
   - æ‚¬åœé«˜äº®è¡Œ

3. **æ“ä½œæŒ‰é’®**
   - ğŸ”„ åˆ·æ–°æ•°æ®ï¼šæ‰‹åŠ¨è§¦å‘æ•°æ®æ›´æ–°
   - â° æ˜¾ç¤ºæœ€åæ›´æ–°æ—¶é—´

### é¢œè‰²ç¼–ç 

- ğŸŸ¢ **ç»¿è‰²**ï¼šåšå¤šå¾—åˆ†ã€æ­£å·®å€¼
- ğŸ”´ **çº¢è‰²**ï¼šåšç©ºå¾—åˆ†ã€è´Ÿå·®å€¼
- ğŸ”µ **è“è‰²/ç´«è‰²**ï¼šä¸»é¢˜è‰²ã€å¸ç§åç§°

---

## ğŸ”Œ é›†æˆçœŸå®æ•°æ®æº

### å½“å‰çŠ¶æ€

ç›®å‰ç³»ç»Ÿä½¿ç”¨**æ¨¡æ‹Ÿæ•°æ®**è¿›è¡Œæ¼”ç¤ºã€‚è¦é›†æˆçœŸå®æ•°æ®æºï¼Œéœ€è¦ä¿®æ”¹`score_system.py`ä¸­çš„æ•°æ®é‡‡é›†é€»è¾‘ã€‚

### çœŸå®APIé›†æˆç¤ºä¾‹

**æ•°æ®æº1 APIæ ¼å¼ï¼ˆç¤ºä¾‹ï¼‰ï¼š**
```python
# ä»ç¬¬ä¸€ä¸ªæ•°æ®æºè·å–æ•°æ®
url_1 = "https://3000-xxx.sandbox.novita.ai/api/depth/history/{symbol}?range={range}"
```

**æ•°æ®æº2 APIæ ¼å¼ï¼ˆç¤ºä¾‹ï¼‰ï¼š**
```python
# ä»ç¬¬äºŒä¸ªæ•°æ®æºè·å–æ•°æ®
url_2 = "https://5011-xxx.sandbox.novita.ai/api/depth/history/{symbol}?range={range}"
```

**ä¿®æ”¹é‡‡é›†å™¨ä»£ç ï¼š**

åœ¨`score_system.py`çš„`ScoreCollector`ç±»ä¸­ï¼Œæ›¿æ¢`generate_mock_score`æ–¹æ³•ä¸ºï¼š

```python
def fetch_real_score(self, symbol: str, time_range: str, source_url: str) -> Tuple[float, float]:
    """ä»çœŸå®APIè·å–å¾—åˆ†æ•°æ®"""
    try:
        url = f"{source_url}/api/depth/history/{symbol}?range={time_range}"
        response = requests.get(url, timeout=10)
        data = response.json()
        
        # æ ¹æ®å®é™…APIå“åº”ç»“æ„æå–å¾—åˆ†
        long_score = data.get('long_score', 0)
        short_score = data.get('short_score', 0)
        
        return long_score, short_score
    except Exception as e:
        print(f"âŒ è·å– {symbol} {time_range} æ•°æ®å¤±è´¥: {e}")
        return 0, 0
```

---

## ğŸ› ï¸ ç»´æŠ¤å’Œç®¡ç†

### å¯åŠ¨æœåŠ¡

```bash
cd /home/user/webapp
python3 score_system.py > score_system.log 2>&1 &
```

### åœæ­¢æœåŠ¡

```bash
# æ‰¾åˆ°è¿›ç¨‹ID
ps aux | grep score_system.py

# åœæ­¢æœåŠ¡
kill <PID>
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f /home/user/webapp/score_system.log

# æŸ¥çœ‹æœ€è¿‘100è¡Œ
tail -100 /home/user/webapp/score_system.log
```

### æ•°æ®åº“ç®¡ç†

```bash
# è¿›å…¥æ•°æ®åº“
cd /home/user/webapp
sqlite3 crypto_data.db

# æŸ¥çœ‹è¡¨
.tables

# æŸ¥çœ‹æœ€è¿‘çš„ç»Ÿè®¡æ•°æ®
SELECT * FROM score_statistics 
ORDER BY update_time DESC 
LIMIT 10;

# æŸ¥çœ‹ç‰¹å®šå¸ç§çš„å†å²
SELECT * FROM score_history 
WHERE symbol = 'BTC-USDT-SWAP' 
ORDER BY record_time DESC 
LIMIT 20;
```

---

## ğŸ“ˆ æ•°æ®è§£è¯»æŒ‡å—

### å¹³å‡å·®å€¼è§£è¯»

**æ­£å€¼ï¼ˆ> 0ï¼‰ï¼š**
- ğŸ’š å¹³å‡åšå¤šå¾—åˆ† > å¹³å‡åšç©ºå¾—åˆ†
- ğŸ“ˆ å¸‚åœºå€¾å‘çœ‹å¤š
- ç¤ºä¾‹ï¼š`+2.5` è¡¨ç¤ºåšå¤šæƒ…ç»ªå¼ºäºåšç©ºæƒ…ç»ª

**è´Ÿå€¼ï¼ˆ< 0ï¼‰ï¼š**
- â¤ï¸ å¹³å‡åšå¤šå¾—åˆ† < å¹³å‡åšç©ºå¾—åˆ†
- ğŸ“‰ å¸‚åœºå€¾å‘çœ‹ç©º
- ç¤ºä¾‹ï¼š`-1.8` è¡¨ç¤ºåšç©ºæƒ…ç»ªå¼ºäºåšå¤šæƒ…ç»ª

**æ¥è¿‘é›¶ï¼ˆâ‰ˆ 0ï¼‰ï¼š**
- ğŸŸ¡ åšå¤šåšç©ºæƒ…ç»ªç›¸å½“
- âš–ï¸ å¸‚åœºå¤„äºå¹³è¡¡çŠ¶æ€
- ç¤ºä¾‹ï¼š`+0.3` æˆ– `-0.2` è¡¨ç¤ºæƒ…ç»ªæ¥è¿‘ä¸­æ€§

### æ—¶é—´æ®µåˆ†æå»ºè®®

1. **çŸ­æœŸï¼ˆ3m, 1hï¼‰**
   - åæ˜ å³æ—¶å¸‚åœºæƒ…ç»ª
   - é€‚åˆçŸ­çº¿äº¤æ˜“å‚è€ƒ
   - æ³¢åŠ¨è¾ƒå¤§ï¼Œéœ€è°¨æ…åˆ¤æ–­

2. **ä¸­æœŸï¼ˆ3h, 6hï¼‰**
   - åæ˜ æ—¥å†…è¶‹åŠ¿
   - é€‚åˆæ³¢æ®µäº¤æ˜“å‚è€ƒ
   - æ³¢åŠ¨è¶‹äºå¹³ç¨³

3. **é•¿æœŸï¼ˆ12h, 24hï¼‰**
   - åæ˜ æ•´ä½“è¶‹åŠ¿
   - é€‚åˆè¶‹åŠ¿äº¤æ˜“å‚è€ƒ
   - æ³¢åŠ¨æœ€å°ï¼Œæ›´ç¨³å®š

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®å‡†ç¡®æ€§**
   - å½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œä»…ä¾›æ¼”ç¤º
   - çœŸå®äº¤æ˜“å‰éœ€æ¥å…¥å®é™…æ•°æ®æº
   - å»ºè®®å¤šç»´åº¦äº¤å‰éªŒè¯

2. **é£é™©æç¤º**
   - å¾—åˆ†ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
   - åŠ å¯†è´§å¸å¸‚åœºæ³¢åŠ¨å¤§ï¼Œè¯·è°¨æ…å†³ç­–
   - å»ºè®®ç»“åˆå…¶ä»–æŠ€æœ¯æŒ‡æ ‡ç»¼åˆåˆ¤æ–­

3. **ç³»ç»Ÿé™åˆ¶**
   - æ›´æ–°é¢‘ç‡ï¼š3åˆ†é’Ÿ
   - å†å²æ•°æ®ä¿ç•™ï¼šé»˜è®¤24å°æ—¶
   - å¹¶å‘æ”¯æŒï¼šå•è¿›ç¨‹ï¼Œé€‚åˆä¸­å°è§„æ¨¡ä½¿ç”¨

---

## ğŸ”„ ç³»ç»Ÿæ›´æ–°è®°å½•

### V1.0ï¼ˆ2025-12-03ï¼‰

âœ… **æ ¸å¿ƒåŠŸèƒ½**
- å¤šæ•°æ®æºæ”¯æŒæ¡†æ¶
- 6ä¸ªæ—¶é—´æ®µç»Ÿè®¡åˆ†æ
- åšå¤š/åšç©ºå¾—åˆ†è®¡ç®—
- å¹³å‡å·®å€¼ç»Ÿè®¡
- Webå¯è§†åŒ–ç•Œé¢
- RESTful APIæ¥å£
- SQLiteæ•°æ®æŒä¹…åŒ–
- è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼ˆ3åˆ†é’Ÿï¼‰

ğŸ“Š **ç»Ÿè®¡æŒ‡æ ‡**
- å¹³å‡åšå¤šå¾—åˆ†
- å¹³å‡åšç©ºå¾—åˆ†
- å¹³å‡å·®å€¼
- å¸ç§æ•°é‡
- è¶‹åŠ¿åˆ¤æ–­

ğŸ¨ **ç•Œé¢ç‰¹æ€§**
- å“åº”å¼è®¾è®¡
- å®æ—¶æ•°æ®æ›´æ–°
- æ‰‹åŠ¨åˆ·æ–°åŠŸèƒ½
- è¯¦ç»†æ•°æ®è¡¨æ ¼
- è¶‹åŠ¿æŒ‡ç¤ºå™¨

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `score_system.py` | ä¸»ç¨‹åº |
| `score_system.html` | Webç•Œé¢ |
| `score_system.log` | è¿è¡Œæ—¥å¿— |
| `crypto_data.db` | æ•°æ®åº“ |
| `SCORE_SYSTEM_GUIDE.md` | æœ¬æ–‡æ¡£ |

### å¿«é€Ÿå‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
ps aux | grep score_system

# é‡å¯æœåŠ¡
pkill -f score_system.py
python3 score_system.py > score_system.log 2>&1 &

# æµ‹è¯•API
curl http://localhost:5009/api/score/statistics

# æ¸…ç©ºæ•°æ®åº“é‡æ–°å¼€å§‹
rm crypto_data.db
python3 score_system.py
```

---

## ğŸ“š ç›¸å…³èµ„æº

- ğŸ“– [Flask æ–‡æ¡£](https://flask.palletsprojects.com/)
- ğŸ“– [SQLite æ–‡æ¡£](https://www.sqlite.org/docs.html)
- ğŸ”§ [é¡¹ç›®GitHubä»“åº“](https://github.com/jamesyidc/6666)

---

**æœ€åæ›´æ–°ï¼š** 2025-12-03 15:20:00  
**ç‰ˆæœ¬ï¼š** V1.0  
**çŠ¶æ€ï¼š** âœ… è¿è¡Œä¸­

---

*æ³¨ï¼šæœ¬ç³»ç»Ÿè®¾è®¡ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„ï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚*
